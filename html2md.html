<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HTML to Markdown Converter</title>
    <script src="https://unpkg.com/turndown/dist/turndown.js"></script>
    <style>
        body {
            max-width: 800px;
            margin: 20px auto;
            padding: 0 20px;
            font-family: Arial, sans-serif;
        }
        textarea {
            width: 100%;
            min-height: 200px;
            margin: 10px 0;
            padding: 10px;
        }
        button {
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <h1>HTML to Markdown Converter</h1>

    <p id="description">
        A simple tool to convert HTML to Markdown - either paste HTML directly or fetch from a URL.
    </p>

    <div style="margin-bottom: 20px;">
        <h2>URL Input (optional):</h2>
        <input type="url" id="urlInput" placeholder="Enter URL" style="width: 70%; padding: 8px;">
        <button onclick="fetchAndConvert()">Fetch & Convert</button>
    </div>

    <h2>HTML Input:</h2>
    <textarea id="htmlInput" placeholder="Paste your HTML here"></textarea>

    <button onclick="convertToMarkdown()">Convert to Markdown</button>

    <h2>Markdown Output:</h2>
    <textarea id="markdownOutput" readonly placeholder="Your markdown will appear here"></textarea>
    <button onclick="copyToClipboard(this)">Copy to Clipboard</button>

    <script>
        async function copyToClipboard(button) {
            const markdown = document.getElementById('markdownOutput').value;
            await navigator.clipboard.writeText(markdown);

            const originalText = button.textContent;
            button.textContent = 'Copied!';
            button.style.backgroundColor = '#45a049';

            setTimeout(() => {
                button.textContent = originalText;
                button.style.backgroundColor = '#4CAF50';
            }, 1500);
        }

        async function fetchAndConvert() {
            const url = document.getElementById('urlInput').value;
            try {
                const response = await fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent(url));
                const html = await response.text();
                document.getElementById('htmlInput').value = html;
                convertToMarkdown();
            } catch (error) {
                alert('Error fetching URL: ' + error.message);
            }
        }

        function convertToMarkdown() {
            const htmlInput = document.getElementById('htmlInput').value;
            const turndownService = new TurndownService();
            const markdown = turndownService.turndown(htmlInput);
            document.getElementById('markdownOutput').value = markdown;
        }
    </script>
</body>
</html>
